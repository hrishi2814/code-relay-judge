<!DOCTYPE html>
<html>
<head>
  <title>Code Relay Admin</title>
  <link rel="stylesheet" href="/css/output.css">
</head>
<body class="bg-gray-50 text-gray-800">
  <div class="max-w-5xl mx-auto p-4">
    <header class="mb-8">
      <h1 class="text-3xl font-bold text-indigo-600 mb-2">Code Relay Admin Dashboard</h1>
      <a href="/" class="text-blue-500 hover:text-blue-700">‚Üê Back to Submission Page</a>
    </header>
    
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
      <h2 class="text-xl font-semibold text-indigo-700 mb-4">Competition Controls</h2>
      <div class="flex gap-4">
        <button onclick="startCompetition()" class="bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded-md shadow">
          Start Competition
        </button>
        <button onclick="pauseCompetition()" class="bg-yellow-500 hover:bg-yellow-600 text-white py-2 px-4 rounded-md shadow">
          Pause Competition
        </button>
        <button onclick="confirmReset()" class="bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-md shadow">
          Reset Competition
        </button>
      </div>
    </div>

    <h2 class="text-xl font-semibold text-indigo-700 mb-4">Team Status</h2>
    <div id="teams-container" class="space-y-4"></div>
  </div>
  
  <script>
    async function updateStatus() {
      const response = await fetch('/admin-status');
      const data = await response.json();
      
      const container = document.getElementById('teams-container');
      container.innerHTML = '';
      
      data.teams.forEach(team => {
        const teamDiv = document.createElement('div');
        teamDiv.className = 'bg-white rounded-lg shadow-md p-6 border-l-4 border-indigo-500 transition-all hover:shadow-lg';
        teamDiv.innerHTML = `
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-semibold">${team.name}</h3>
            <span class="bg-indigo-100 text-indigo-800 py-1 px-3 rounded-full font-medium">Score: ${team.score}</span>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="bg-gray-50 p-4 rounded-md">
              <h4 class="font-medium mb-2">Problem 1</h4>
              <p class="${team.problems.problem1 ? 'text-green-600' : 'text-gray-500'}">${team.problems.problem1 || 'Not attempted'}</p>
            </div>
            <div class="bg-gray-50 p-4 rounded-md">
              <h4 class="font-medium mb-2">Problem 2</h4>
              <p class="${team.problems.problem2 ? 'text-green-600' : 'text-gray-500'}">${team.problems.problem2 || 'Not attempted'}</p>
            </div>
            <div class="bg-gray-50 p-4 rounded-md">
              <h4 class="font-medium mb-2">Problem 3</h4>
              <p class="${team.problems.problem3 ? 'text-green-600' : 'text-gray-500'}">${team.problems.problem3 || 'Not attempted'}</p>
            </div>
          </div>
        `;
        container.appendChild(teamDiv);
      });
    }
    
    function confirmReset() {
      if (confirm('Are you sure you want to reset the competition? This will clear all submissions and scores.')) {
        resetCompetition();
      }
    }

    async function resetCompetition() {
      try {
        const response = await fetch('/reset', { method: 'POST' });
        if (response.ok) {
          alert('Competition reset successfully');
          updateStatus();
        } else {
          alert('Failed to reset competition');
        }
      } catch (error) {
        console.error('Error resetting competition:', error);
        alert('Error resetting competition');
      }
    }

    async function startCompetition() {
      // Add competition start logic
      alert('Competition started');
    }

    async function pauseCompetition() {
      // Add competition pause logic
      alert('Competition paused');
    }

    // Update every 5 seconds
    setInterval(updateStatus, 5000);
    updateStatus();
  </script>
</body>
</html>
